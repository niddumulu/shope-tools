<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Baca CSV Kolom P</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; max-width: 600px; }
    textarea { width: 100%; height: 200px; margin-top: 10px; }
    button { margin: 5px 0; padding: 8px 15px; font-size: 14px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Upload CSV (ambil kolom P)</h2>
  <input type="file" id="csvFile" accept=".csv"><br><br>
  <button onclick="processCSV()">Upload & Proses</button>
  <p id="status"></p>
  <textarea id="output" readonly></textarea><br>
  <button onclick="copyData()" id="copyBtn" style="display:none;">Copy</button>

  <script>
    function processCSV() {
      const fileInput = document.getElementById("csvFile");
      const file = fileInput.files[0];
      if (!file) {
        alert("Pilih file CSV terlebih dahulu!");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const text = e.target.result;
        const rows = text.split(/\r?\n/).filter(r => r.trim() !== "");
        if (rows.length <= 1) {
          document.getElementById("status").innerText = "Tidak ada data.";
          return;
        }

        const headers = rows[0].split(",");
        const pIndex = headers.findIndex(h => h.trim().toLowerCase() === "p");
        if (pIndex === -1) {
          alert("Kolom 'p' tidak ditemukan di header CSV!");
          return;
        }

        let result = [];
        for (let i = 1; i < rows.length; i++) {
          const cols = rows[i].split(",");
          if (cols[pIndex]) {
            result.push(cols[pIndex].trim());
          }
        }

        document.getElementById("output").value = result.join("\n");
        document.getElementById("status").innerText = 
          "Sudah terupload " + result.length + " data.";
        document.getElementById("copyBtn").style.display = "inline-block";
      };
      reader.readAsText(file);
    }

    function copyData() {
      const textarea = document.getElementById("output");
      textarea.select();
      textarea.setSelectionRange(0, 99999); // untuk mobile
      document.execCommand("copy");
      alert("Data berhasil dicopy!");
    }
  </script>
</body>
</html>
