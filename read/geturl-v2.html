<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ambil Link Produk Shopee</title>

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    max-width: 800px;
    margin-inline: auto;
  }

  h2, h3 {
    text-align: center;
  }

  textarea {
    width: 100%;
    height: 220px;
    padding: 10px;
    font-family: monospace;
    font-size: 14px;
    margin-bottom: 20px;
  }
</style>
</head>
<body>

<h2>ðŸ“‚ Ambil Link Produk Shopee dari CSV</h2>

<input type="file" id="csvFile" accept=".csv">

<h3>Hasil Asli (Boleh Duplikat)</h3>
<textarea id="outputRaw" readonly></textarea>

<h3>Hasil Unik (Urut Duplikat Terbanyak)</h3>
<textarea id="outputUnique" readonly></textarea>

<script>
document.getElementById('csvFile').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(ev) {
    const lines = ev.target.result
      .split('\n')
      .map(l => l.trim())
      .filter(l => l);

    const rows = lines.map(r =>
      r.split(',').map(c => c.replace(/^"|"$/g, ''))
    );

    const headers = rows[0];
    const data = rows.slice(1);

    const shopIndex = headers.findIndex(h => h.trim() === 'ID Shop');
    const prodIndex = headers.findIndex(h => h.trim() === 'ID Barang');

    if (shopIndex === -1 || prodIndex === -1) {
      alert('Kolom "ID Shop" atau "ID Barang" tidak ditemukan!');
      return;
    }

    // ðŸ”¹ Hasil asli
    const links = data.map(r =>
      `https://shopee.co.id/product/${r[shopIndex]}/${r[prodIndex]}`
    );

    document.getElementById('outputRaw').value = links.join('\n');

    // ðŸ”¹ Hitung duplikat
    const counter = {};
    links.forEach(link => {
      counter[link] = (counter[link] || 0) + 1;
    });

    // ðŸ”¹ Urutkan berdasarkan jumlah terbanyak
    const uniqueSorted = Object.entries(counter)
      .sort((a, b) => b[1] - a[1])
      .map(item => item[0]);

    document.getElementById('outputUnique').value = uniqueSorted.join('\n');
  };

  reader.readAsText(file);
});
</script>

</body>
</html>
