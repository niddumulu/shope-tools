<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filter Otomatis Berdasarkan ID Toko Shopee</title>
<style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: #fffdf8;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  h1 {
    color: #b36b00;
    text-align: center;
    margin-bottom: 10px;
  }
  .filter-box {
    background: #fffbe6;
    border: 1px solid #ffd42a;
    border-radius: 8px;
    padding: 16px;
    max-width: 700px;
    margin: 0 auto 25px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
  }
  textarea {
    width: 100%;
    height: 90px;
    font-size: 0.95rem;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 6px;
    resize: vertical;
    box-sizing: border-box;
  }
  .result-area {
    max-width: 700px;
    margin: 0 auto;
    background: #fdfdfd;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 12px;
  }
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 8px 0 14px;
    gap: 8px;
  }
  .pagination button {
    background: #f5f5f5;
    color: #333;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 6px 12px;
    font-size: 0.9rem;
  }
  .pagination button.active {
    background: #b36b00;
    color: white;
  }
  pre {
    background: #fff;
    border-radius: 6px;
    padding: 10px;
    max-height: 350px;
    overflow-y: auto;
    font-size: 0.9rem;
    white-space: pre-wrap;
    line-height: 1.4;
  }
</style>
</head>
<body>

<h1>Filter Otomatis Berdasarkan ID Toko Shopee</h1>

<div class="filter-box">
  <p><b>Masukkan ID toko</b> (pisah koma, baris baru, atau link Shopee).  
  Contoh:<br><code>968553125</code> atau <code>https://shopee.co.id/product/30467025/28733961936</code></p>
  <textarea id="idsInput" placeholder="Contoh: 968553125, 30467025"></textarea>
</div>

<div class="result-area">
  <div class="pagination" id="pagination"></div>
  <pre id="output">Memuat data dari localStorage...</pre>
</div>

<script>
/* Ambil semua link dari localStorage */
function getAllLinks(){
  const all=[];
  for(let i=0;i<localStorage.length;i++){
    const key=localStorage.key(i);
    const val=localStorage.getItem(key);
    try{
      const obj=JSON.parse(val);
      if(obj && obj.inputList){
        const lines=obj.inputList.split('\n').map(v=>v.trim()).filter(Boolean);
        all.push(...lines);
      }
    }catch(e){}
  }
  return all;
}

/* Parse ID toko dari input */
function parseIds(){
  const raw=document.getElementById('idsInput').value.trim();
  if(!raw) return [];
  const parts=raw.split(/[\n,; ]+/).map(s=>s.trim()).filter(Boolean);
  const ids=[];
  for(const p of parts){
    const match=p.match(/product\/(\d+)\//);
    if(match){ ids.push(match[1]); continue; }
    const digits=p.replace(/\D/g,'');
    if(digits.length>=5) ids.push(digits);
  }
  return Array.from(new Set(ids));
}

let allLinks=[], filteredLinks=[], currentPage=1;
const perPage=99;

function renderPage(){
  const start=(currentPage-1)*perPage;
  const end=start+perPage;
  const slice=filteredLinks.slice(start,end);
  const totalPages=Math.ceil(filteredLinks.length/perPage)||1;

  document.getElementById('output').textContent=
    slice.length ? slice.join('\n') : 'Tidak ada link ditemukan.';

  const pagDiv=document.getElementById('pagination');
  pagDiv.innerHTML='';
  const prevBtn=document.createElement('button');
  prevBtn.textContent='⬅️ Sebelumnya';
  prevBtn.disabled=currentPage===1;
  prevBtn.onclick=()=>{currentPage--;renderPage();};
  pagDiv.appendChild(prevBtn);

  const info=document.createElement('span');
  info.textContent=`Halaman ${currentPage}/${totalPages} (Total ${filteredLinks.length} link)`;
  pagDiv.appendChild(info);

  const nextBtn=document.createElement('button');
  nextBtn.textContent='➡️ Berikutnya';
  nextBtn.disabled=currentPage===totalPages;
  nextBtn.onclick=()=>{currentPage++;renderPage();};
  pagDiv.appendChild(nextBtn);
}

/* Filter otomatis */
function autoFilter(){
  const ids=parseIds();
  if(ids.length){
    const regex=new RegExp(`product\\/(${ids.join('|')})\\/`);
    filteredLinks=allLinks.filter(link=>!regex.test(link));
  } else {
    filteredLinks=[...allLinks];
  }
  currentPage=1;
  renderPage();
}

/* Inisialisasi */
window.addEventListener('DOMContentLoaded', ()=>{
  allLinks=getAllLinks();
  filteredLinks=[...allLinks];
  renderPage();
  document.getElementById('idsInput').addEventListener('input', ()=>{
    autoFilter();
  });
});
</script>

</body>
</html>