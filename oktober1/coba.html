<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Link Shopee Pagination</title>
<style>
  body { font-family: Arial, sans-serif; margin: 15px; max-width: 700px; margin-left:auto; margin-right:auto;}
  textarea { width: 100%; height: 150px; margin-top: 10px; }
  button { margin: 5px 2px; padding: 5px 10px; cursor: pointer; }
  #output a { display: block; margin-bottom: 4px; word-break: break-all; }
  .hidden { display: none; }
  .pagination { margin-top: 10px; text-align: center; }
  .pagination button { margin: 0 3px; padding: 4px 8px; }
</style>
</head>
<body>
<h2>üì¶ Link Shopee Pagination</h2>
<textarea id="inputData" placeholder="Tempelkan link Shopee di sini..."></textarea><br>

<div>
  <button id="toggleTokoBtn">üîΩ Sembunyikan ID Toko</button>
  <button id="toggleOutputBtn">üîΩ Sembunyikan Output Link</button>
  <button id="processBtn">Proses Link</button>
</div>

<h3>ID Toko:</h3>
<div id="tokoContainer"></div>

<h3>Output Link:</h3>
<div id="output"></div>

<div class="pagination" id="pagination"></div>

<script>
const inputData = document.getElementById('inputData');
const outputDiv = document.getElementById('output');
const tokoContainer = document.getElementById('tokoContainer');
const paginationDiv = document.getElementById('pagination');
const processBtn = document.getElementById('processBtn');
const toggleTokoBtn = document.getElementById('toggleTokoBtn');
const toggleOutputBtn = document.getElementById('toggleOutputBtn');

const pageKey = location.pathname.split('/').pop() || 'default';
const itemsPerPage = 10;

let allLinks = [];
let currentPage = parseInt(localStorage.getItem(`${pageKey}_currentPage`)) || 1;

function processLinks(){
  const lines = inputData.value.trim().split(/\n+/).filter(Boolean);
  const uniqueLinks = [...new Set(lines)];
  allLinks = uniqueLinks;
  showPage(currentPage);
  renderPagination();
  saveData();
}

function showPage(page){
  currentPage = page;
  localStorage.setItem(`${pageKey}_currentPage`, currentPage);
  const start = (page-1)*itemsPerPage;
  const end = start+itemsPerPage;
  const pageLinks = allLinks.slice(start, end);

  // tampilkan ID toko
  const ids = pageLinks.map(link => link.match(/product\/(\d+)/)?.[1] || 'tidak ditemukan');
  tokoContainer.innerHTML = ids.join('<br>');

  // tampilkan link klikabel
  outputDiv.innerHTML = '';
  pageLinks.forEach(link=>{
    const a = document.createElement('a');
    a.href = link; a.textContent = link; a.target = "_blank";
    outputDiv.appendChild(a);
  });
}

function renderPagination(){
  const totalPages = Math.ceil(allLinks.length/itemsPerPage);
  paginationDiv.innerHTML = '';
  for(let i=1;i<=totalPages;i++){
    const btn = document.createElement('button');
    btn.textContent = i;
    if(i===currentPage) btn.disabled = true;
    btn.addEventListener('click', ()=>showPage(i));
    paginationDiv.appendChild(btn);
  }
}

function saveData(){
  localStorage.setItem(`${pageKey}_links`, JSON.stringify(allLinks));
  localStorage.setItem(`${pageKey}_input`, inputData.value);
}

// ===== TOMBOL SEMBUNYIKAN / TAMPILKAN =====
toggleTokoBtn.addEventListener('click',()=>{
  const isHidden = tokoContainer.style.display==='none';
  if(isHidden){
    tokoContainer.style.display='block';
    toggleTokoBtn.innerHTML='üîΩ Sembunyikan ID Toko';
    localStorage.setItem(`${pageKey}_showToko`, 'true');
  }else{
    tokoContainer.style.display='none';
    toggleTokoBtn.innerHTML='‚ñ∂Ô∏è Tampilkan ID Toko';
    localStorage.setItem(`${pageKey}_showToko`, 'false');
  }
});

toggleOutputBtn.addEventListener('click',()=>{
  const isHidden = outputDiv.style.display==='none';
  if(isHidden){
    outputDiv.style.display='block';
    toggleOutputBtn.innerHTML='üîΩ Sembunyikan Output Link';
    localStorage.setItem(`${pageKey}_showOutput`, 'true');
  }else{
    outputDiv.style.display='none';
    toggleOutputBtn.innerHTML='‚ñ∂Ô∏è Tampilkan Output Link';
    localStorage.setItem(`${pageKey}_showOutput`, 'false');
  }
});

// ===== SIMPAN SAAT DIPROSES =====
processBtn.addEventListener('click', processLinks);

// ===== PULIHKAN SAAT HALAMAN DIBUKA =====
window.onload = ()=>{
  const savedLinks = localStorage.getItem(`${pageKey}_links`);
  const savedInput = localStorage.getItem(`${pageKey}_input`);
  const savedPage = localStorage.getItem(`${pageKey}_currentPage`);
  const showToko = localStorage.getItem(`${pageKey}_showToko`);
  const showOutput = localStorage.getItem(`${pageKey}_showOutput`);

  if(savedInput){ inputData.value = savedInput; }
  if(savedLinks){ allLinks = JSON.parse(savedLinks); }
  if(savedPage){ currentPage = parseInt(savedPage); }

  // tampilkan halaman terakhir
  showPage(currentPage);
  renderPagination();

  // pulihkan status tampil/sembunyi ID toko
  if(showToko === 'false'){
    tokoContainer.style.display='none';
    toggleTokoBtn.innerHTML='‚ñ∂Ô∏è Tampilkan ID Toko';
  }else{
    tokoContainer.style.display='block';
    toggleTokoBtn.innerHTML='üîΩ Sembunyikan ID Toko';
  }

  // pulihkan status tampil/sembunyi Output link
  if(showOutput === 'false'){
    outputDiv.style.display='none';
    toggleOutputBtn.innerHTML='‚ñ∂Ô∏è Tampilkan Output Link';
  }else{
    outputDiv.style.display='block';
    toggleOutputBtn.innerHTML='üîΩ Sembunyikan Output Link';
  }
};
</script>
</body>
</html>
